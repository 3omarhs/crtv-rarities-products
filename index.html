<script>
    // 1. PASTE YOUR PUBLISHED CSV URL HERE
    const SHEET_URL = 'https://docs.google.com/spreadsheets/d/e/2PACX-1vSTejg41yuaKcYa0CbOodUP9osmE5DIv8ZNQyMXlHJLLh2pQUZ5EoMT93UgV3LZfhAJcPEL8uEfK9Y4/pub?gid=897526080&single=true&output=csv';

    async function loadProducts() {
        try {
            const response = await fetch(SHEET_URL);
            if (!response.ok) throw new Error('Could not fetch data');
            
            const csvText = await response.text();
            const rows = csvText.split(/\r?\n/).slice(1); // Skip headers
            const container = document.getElementById('links-container');
            container.innerHTML = ''; // Clear loading message

            rows.forEach(row => {
                // Splits by comma but handles names with commas inside quotes
                const columns = row.split(/,(?=(?:(?:[^"]*"){2})*[^"]*$)/);
                
                const name = columns[1]?.replace(/^"|"$/g, '').trim();  // Product Name (Col B)
                const id = columns[2]?.replace(/^"|"$/g, '').trim();    // No attribute (Col C)
                const link = columns[12]?.replace(/^"|"$/g, '').trim(); // Document Link (Col M)

                if (name && id) {
                    container.innerHTML += `
                        <a href="${link || '#'}" class="link-card" target="_blank">
                            <span class="link-title">${name}</span>
                            <span class="link-id">${id}</span>
                        </a>`;
                }
            });
        } catch (error) {
            console.error('Error:', error);
            document.getElementById('links-container').innerHTML = 
                `<p style="color:red; padding:20px;">Error loading products. Make sure your Sheet is "Published to Web" as a CSV.</p>`;
        }
    }

    loadProducts();
</script>